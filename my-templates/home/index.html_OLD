<html xmlns:py="http://genshi.edgewall.org/"
      xmlns:i18n="http://genshi.edgewall.org/i18n"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      py:strip=""
      >

    <py:def function="body_class">${h.literal('no-sidebar')}</py:def>

    <py:def function="page_title">Welcome</py:def>
    <div py:match="//div[@id='content']" class="front-page">

<!--        <div>
            <h1 class="page_heading">${g.site_title}!</h1>   
        </div>-->
        <div class="row slider-row">
            <div class="span8 slider-wrapper theme-default">
                <div id="slider" class="nivoSlider">
                    <a href="/dataset/strutture-ricettive-della-toscana-parz-geo"> <img src="/images/slide1.jpg" alt="Strutture ricettive" /></a>
                    <a href="http://opengovernmentdata.org/" target="_blank"> <img src="/images/slide2.jpg"  alt="Cosa sono gli Open Data?" /></a>
                    <a href="http://www.evpsi.org/librobianco" target="_blank" > <img src="/images/slide3.jpg"  alt="Libro bianco per il riutilizzo dell'informazione del settore pubblico" /></a>
                </div>           
            </div> <!-- slider -->
            <div class="span4 right-slider">
                <h2>Find data</h2>
                <form action="${h.url_for(controller='package', action='search')}" method="get"> 
                    <div>
                    <input name="q" value="" class="search-field" placeholder="${_('Find datasets')}" /> 
                    </div>
                </form> 
                ${g.site_title} contains <a href="${h.url_for(controller='package', action='search')}">${c.package_count} datasets</a> that you can 
            browse, learn about and download. 
            </div>     
        </div> <!-- class="row slider-row" -->

        <div class="row top-boxes">
            <div class="span4">
                <div class="action-box">
                    <div class="action-box-inner find">
                        <h1 class="last-dataset">Ultimi dataset aggiunti</h1>
                        <ul>
                                                            
                        </ul>

                        <!--                        <form action="${h.url_for(controller='package', action='search')}" method="GET"> 
                                                    <input name="q" value="" class="search-field" placeholder="${_('Find datasets')}" /> 
                                                </form> 
                                                ${g.site_title} contains <a href="${h.url_for(controller='package', action='search')}">${c.package_count} datasets</a> that you can 
                                                browse, learn about and download. -->
                    </div>
                </div>
            </div>
            <div class="span4">
                <div class="action-box">
                    <div class="action-box-inner share">
                        <h1 class="most-view-dataset">Dataset pi√π visitati</h1>
                        <ul>
                        <?python
                            from ckanext.googleanalytics.dbutil import get_top_packages
                        ?>
                        <py:for each="package in get_top_packages(limit=2)">
                            <li>  
                                <h3>${h.link_to(package[0].title or package[0].name, h.url_for(controller='package', action='read', id=package[0].name))}</h3>
                                ${h.markdown_extract(package[0].notes)}
                            </li>                                    
                        </py:for>
                        </ul>
<!--                        Add your own datasets to share them with others and
                        to find other people interested in your data.

                        <py:choose test="h.check_access('package_create')">
                            <a py:when="" href="${h.url_for(controller='package', action='new')}" class="create-button">Create a dataset &raquo;</a>
                            <py:otherwise>
                                <a href="${h.url_for(controller='user', action='login')}" class="create-button">Sign up &raquo;</a>
                            </py:otherwise>
                        </py:choose>-->
                    </div>
                </div>
            </div>
            <div class="span4">
                <div class="action-box">
                    <div class="action-box-inner collaborate">
                        <py:if test="len(c.facets.get('tags', {}))">
                            <div class="tag-cloud-header">
                                <h1 class="tag-cloud">Top Tags</h1>
                            </div>
                            <script src="/scripts/jquery.js" type="text/javascript"></script>


                            <ul id="tags">
                                <?python
                                    tagListTemp = c.facets.get('tags', {}).items()
                                    tagListTemp = sorted(tagListTemp, key=lambda x: x[1])
                                    tagListTemp.reverse()
                                    tagListTemp = tagListTemp[:40]
                                    tagListTemp = sorted(tagListTemp, key=lambda x: x[0])
                                ?>
                                <py:for each="tag_name, count in tagListTemp">
                                    <li value="${count}" title="${tag_name}"><a  href="${h.url_for(controller='tag',
                                                                                 action='read', id=tag_name)}">${tag_name}</a></li>

                                </py:for>
                            </ul>
                            <!-- script type="text/javascript">
                                $("#tags").tagcloud({type:"list",height:212,colormin:"5b5b5b",colormax:"5b5b5b"});
                                $("#tags").ellipsis({ellipsis:""});
                                 $(".top-boxes .action-box").ellipsis({ellipsis:"..."});
                            </script -->
                        </py:if>
                    </div>
                </div>
            </div>
        </div><!-- class="row" -->
        <div py:if="c.groups" class="row whoelse">
            <!--            <div class="span12 action-box" >
                            
                        </div>-->
        </div>
        <div class="row">
            <div class="span8 action-box groups-box">
                <div >

                    <h1 class="groups-box-header">Gruppi</h1>

                    <div class="row">
                        <py:for each="i, group_dict in enumerate(c.groups[:4])">
                            <div class="span4">
                                <div class="group action-box-inner  ">
                                    <h3><a href="${h.url_for(controller='group', action='read', id=group_dict['name'])}">${group_dict['title']}</a></h3>
                                    <p>
                                        ${h.markdown_extract(group_dict['description'])}
                                    </p>
                                    <span class="dataset-qty">&gt; ${group_dict['packages']} datasets.</span>
                                </div>
                            </div>
                        </py:for>
                    </div>
                </div>
            </div>
            <div class="span4">
                <div class="action-box">
                    <div class="action-box-inner twitter-box">

                        <div class="twitter">
                            <div class="twitter-header">
                                <h1 class="twitter-logo">#opendata su twitter</h1>
                            </div>
                               <xi:include href="twitterstream.html" />
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
    <xi:include href="layout.html" />
<script type="text/javascript" src="/scripts/jquery.tagcloud.js"></script>
 <script type="text/javascript" charset="utf-8">
   $(document).ready(function(){
     $.fn.tagcloud.defaults = {
       size: {start: 10, end: 32, unit: "pt"},
       color: {start: '#af8', end: '#f52'}
     };
     $("#tagcloud a").tagcloud();
   })
 </script>
<script type="text/javascript">
$(document).ready(function(){
         $("#tags").tagcloud({type:"list",height:212,colormin:"5b5b5b",colormax:"5b5b5b"});
                                $("#tags").ellipsis({ellipsis:""});
                                 $(".top-boxes .action-box").ellipsis({ellipsis:"..."})
});
</script>
 <script type="text/javascript" src="/scripts/jquery.nivo.slider.js"></script>
 <script src="/scripts/jquery.tinysort.min.js"  type="text/javascript"></script>
 <script type="text/javascript" src="/scripts/jquery.autoellipsis-1.0.6.min.js"></script>
 <script src="/scripts/jquery.tagcloud.min.js"  type="text/javascript"></script>
</html>

